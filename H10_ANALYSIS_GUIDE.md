# H10竞品分析服务使用指南

## ✅ 已完成的功能

### 1. 前端界面
- ✅ 14 个单独的文件上传按钮（横向排列）
- ✅ 文件夹选择功能（自动识别文件）
- ✅ "开始搭建词库" 按钮
- ✅ 文件自动匹配和验证

### 2. 后端处理逻辑
- ✅ 第一部分：AN 列标记（A-F 优先级）
- ✅ 第二部分：AO 列标记（词类型分类）
- ✅ 第三部分：AP 列标记（流量等级）
- ✅ 自动下载处理后的 Excel 文件

## 📋 文件要求

### 必需文件
- **H10反查总表**（必需）

### 可选文件
- **竞品1-10**（任意数量）
- **自身ASIN反查**
- **竞对ABA热搜词反查**（需要包含"多asin反查流量"工作表）
- **拓词基础表**（A-E 列）

## 🔧 处理逻辑说明

### 第一部分：AN 列标记（优先级：F > E > D > C > B > A）

1. **F** - 关键词在"自身ASIN反查"中出现
2. **E** - 关键词在"竞对ABA热搜词反查"的"多asin反查流量"工作表中出现
3. **D** - 关键词在"竞品1-10"中出现，且任意竞品的广告排名≤20 **且** 自然排名≤20
4. **C** - 关键词在"竞品1-10"中出现，且任意竞品的仅自然排名≤20（广告排名>20或无值）
5. **B** - 关键词在"竞品1-10"中出现，且任意竞品的仅广告排名≤20（自然排名>20或无值）
6. **A** - 关键词在"竞品1-10"中出现，但所有竞品的广告排名和自然排名都>20或无值；或关键词在竞品中未出现

**注意**：如果同时满足多个条件，仅标记为最高优先级（F > E > D > C > B > A）

### 第二部分：AO 列标记（词类型分类）

使用**单词级匹配**（确保匹配值作为独立词出现）：

1. **不相关词** - 包含拓词基础表 D 列中的任意值
2. **大词或泛词** - 包含 A 列，不包含 B/C/D/E 列
3. **a精准属性精准词** - 包含 A 列和 B 列，不包含 D/E 列
4. **b泛属性精准词** - 包含 A 列和 C 列，不包含 B/D/E 列
5. **相关词** - 包含 B 列或 C 列，不包含 A/D/E 列；或不包含 A/B/C/D/E 列
6. **品牌词** - 包含 E 列

### 第三部分：AP 列标记（流量等级）

根据搜索量（D列）累计百分比：

- **高流量词1** - 累计搜索量 0-40%
- **中高流量词2** - 累计搜索量 40-70%
- **中低流量词3** - 累计搜索量 70-90%
- **低流量词4** - 累计搜索量 90-100%

## 📝 使用方法

### 方式一：分别上传文件

1. 点击每个表格对应的"选择文件"按钮
2. 上传对应的 Excel 文件
3. 至少上传"H10反查总表"
4. 点击"开始搭建词库"按钮

### 方式二：选择文件夹

1. 将所有表格文件放在一个文件夹中
2. 点击"选择文件夹"按钮
3. 选择包含所有表格的文件夹
4. 系统会自动识别文件名并匹配
5. 点击"开始搭建词库"按钮

## 📊 输出结果

处理完成后，会自动下载一个名为 `H10反查总表.xlsx` 的 Excel 文件，包含：

- 原始数据
- **AN 列**：优先级标记（A-F）
- **AO 列**：词类型分类
- **AP 列**：流量等级（1-4）

## ⚠️ 注意事项

1. **文件格式**：只支持 `.xlsx` 和 `.xls` 格式
2. **必需文件**：H10反查总表是必需的，其他文件可选
3. **工作表名称**：竞对ABA热搜词反查文件需要包含"多asin反查流量"工作表
4. **列名识别**：系统会自动查找包含"关键词"或"词组"的列
5. **搜索量列**：AP 列标记需要 D 列（第4列）包含搜索量数据

## 🐛 故障排除

如果遇到问题：

1. **检查文件格式**：确保是 Excel 文件（.xlsx 或 .xls）
2. **检查列名**：确保 H10反查总表包含关键词列和搜索量列（D列）
3. **查看后端日志**：检查 Railway 日志了解详细错误信息
4. **验证文件内容**：确保文件不为空且格式正确

## 📞 需要帮助？

如果处理失败，请检查：
- 文件是否包含必需的数据列
- 列名是否符合预期（系统会自动查找包含"关键词"的列）
- 文件是否损坏或格式不正确





